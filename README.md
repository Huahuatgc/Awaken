# Awaken

一个多端同步阅读软件：

1. 支持桌面（Windows、macOS、理论Linux）和移动端（安卓、iOS）。
2. 基于**WebDAV**的书籍管理，支持进度、笔记、书签同步，并且支持从**Kindle**导入笔记。
3. 仅支持**EPUB**电子书，其他的可以自行转换，例如[一键批量下载 Kindle 全部电子书工具 + 移除 DRM 解密插件 + 格式转换教程 (开源免费)](https://www.iplaysoft.com/kindle-download-dedrm.html)。

**本项目不接任何需求，但是欢迎任何BUG修复或功能性的PR，当然那种什么代码不符合你的审美改改格式、改改先进的构建工具之类的还是算了，恕我懒得处理**。

功能展示见：

![![]()]()

## 应用包

1. Windows：
2. Mac：
3. 安卓：
4. iOS：99刀开发者账户好贵...先不传了，需要的自己编吧。

## 开发

首先`Clone`整个仓库，初始化项目：

```sh
nom run init
```

接着运行开发指令：

```sh
npm run dev
```

然后查到**本机IP地址**，记`DEV_URL = ${IP}:8888`，分平台处理：

### 桌面端

在对应的操作系统上，执行一句命令即可：

```sh
npm run dev-desktop
```

但注意需要在**非虚拟机包括WSL**环境执行。

### 安卓端

用最新的**Android Studio**打开**platform/android**下的工程，然后修改`MainActivity.kt`中的字段：

```kotlin
private val host: String = "http://${DEV_URL}"
```

接着连上设备调试即可。

### iOS端

用**XCode**打开**platform/ios**下的工程，然后修改`ContentView.swift`中的字段：

```kotlin
let host: String = "http://${DEV_URL}"
```

接着连上设备调试即可。

## 测试

测试很简单，如果实在桌面端，需要你一开始选择一个空目录作为本地书籍存储，可以选择**test/client**目录，接着在主界面的**设定**中，填入以下配置：

1. 地址：http://${IP}:8889/dav/
2. 用户名：dtysky
3. 密码：114514

确认后即连接到本地调试服务器，接下来你可以在**test**目录中找到一些测试用书籍，来测试添加、删除、阅读等等功能。本地测试服务器的文件落在了**test/server/dav**下。

## 发布

发布首先要执行指令：

```sh
npm run build
```

然后分平台处理：

### 桌面端

直接执行：

```sh
npm run release-desktop
```

即可，但同样需要在**非虚拟机包括WSL**环境执行。如果只发布桌面端，也可以直接执行：

```sh
npm run release
```

产物在`platforms/desktop/target/release/bundle`中。

### 安卓端

打开项目工程，在`Build` -> `Select Build Variants`窗口，设置选择为`release`模式，然后`Build` -> `Generate Signed Build or APK`即可，可能需要重新生成签名文件。

产物在`platforms/android/app/release`中。

### iOS端

打开项目工程，构建的`schema`选择`release`即可。

## todo

1. 移动端，默认选择文本后的弹窗。

## Copyright

**Copyright © 2022, 戴天宇, Tianyu Dai (dtysky < dtysky@outlook.com >). All Rights Reserved.**  
**This project is free software and released under the** [GNU Lesser General Public License (LGPL)](https://www.gnu.org/licenses/lgpl-3.0.en.html).**

## 录制剧本

大家好，我是瞬光。我利用这两个月的业余时间，开发了一个基于WebDAV同步的开源跨平台阅读软件，还支持`Kindle`笔记的导入，想着做都做了还是录个功能展示视频吧。

首先在面前的是三台不同的设备，左边是iPhone，中间这个大屏幕是PC，右边这个是安卓平板。

先让我们来打开这个软件（打开各个软件）。

可以看到移动端没有过多提示，而PC端需要你自己选择一个文件件，我就选择这个测试文件夹了。

好，接下来为了使用同步功能，我需要现在三个设备都输入webdav服务器地址和账号密码（输入中...

当然本地使用也是可以的，但不建议。

现在三端都连上服务端并验证过了，接下来让我们从PC端添加一些书籍（添加中...

添加完毕后，再让两端分别同步书籍（同步中...

好，现在都同步完了，接下来我们尝试从安卓端删除一本书（删除...

然后同步其他两端（同步中...

这就是书籍列表的基本功能，接下来让我们打开图书。

比如这里我打开这篇生日文章吧，顺便演示一点功能（打开中...

可以看到第一次打开会比较慢，因为在生成索引，接下来就可以正常阅读了。

首先切换页面可以在PC可以用键盘左右，然后所有端都可以点击界面的左右两侧空白切换上下页。

也可以拖动或点击进度条快速切换。

还可以打开目录界面，切换到具体章节。

同时这里还可以点击这个按钮，添加书签，可以打开书签和笔记列表看到它，之后可以用它跳转。当然再次点击可以删除书签。

接下来我们可以添加笔记，还可以添加标注，同样也可以在列表里看到并删除，还可以复制文本，这里就不演示了先。

最后，我们可以点击这个按钮手动同步阅读进度和笔记书签到远端，当然如果返回主界面，或是在移动端压后台也是可以同步的。

接下来让我们在移动端打开同样的书籍（打开中...

打开后可以看到说阅读进度，点击跳转可以跳转，接下来打开笔记和书签栏目，看到确实被同步了，这时候我们在其他端删除一个笔记，添加一个笔记，然后同步其他两端看看？嗯，被同步了。

同步功能差不多到这，还有些阅读小功能，比如脚注跳转（演示三端），再比如外部链接打开（演示三端），基本就如此了。

接下来一个功能是主题切换，我内置了一些主题供用户选择，同时可以设置字体大小、字间距行间距等（展示...

最后一个功能就是Kindle笔记导入了，这里让我们先打开另一本书——就以《加缪全集》为例吧，打开后可以看到没有任何笔记。

对了如何将`Kindle`的书籍下载并导出为`EPUB`，可以看项目主页我的说明。

接下来我们返回主页，然后点击这里，接着选择从`Kindle`桌面端导出的笔记文件，如果我们先选择一个错的——会报错。

然后我们选择对的，可以看很快就导入完了，但有个笔记没能正常导入，但会有提示并贴到剪切板里。

接下来让我们再次点入书籍，可以看到已经导入成功了，然后让我们在其他两端进入书籍，可以看到笔记也被正确同步了。

到此，演示结束。
